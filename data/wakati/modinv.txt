拡張 Euclid の 互除 法 による 逆 元 計算 
atcoder で mod 計算 に 困っ た ので ， 次 から 困ら ない よう に マクロ を 書い て やろ う と 思い 調査 し た ． 今回 の 問題 は ， mod を 使っ た もの で ， 組み合わせ の 計算 を する 時 に ， factorial の モジュラ 逆 元 を 計算 し なけれ ば いけ なく て 困っ た ． 
問題 
を 計算 する と は すなわち ， 
を 満たす を 求め たい という こと に なる ． 
Euclid の 互除 法 を 適用 する と ， 
と なり ， これ を 元 の 式 に 代入 する と ， 
に なる ． これ によって ， に関する 問題 が ， それ より 数値 の 小さな に関する 問題 に 帰着 でき た ． 
これ を 再帰 的 に 解く の が 拡張 Euclid の 互除 法 ． 具体 的 に は ， に関する 小 問題 を 解い て ， 
と 解 が 再帰 的 に 得 られ た と する と ， 
となり ， 元 の 問題 の 解 を 構成 できる ． 
実装 
終了 条件 に 注意 し て 実装 ． 
非 再帰 で 書い た もの を アンローリング 展開 し て いる もの （ コード は 理解 でき ない ） は 以下 ． 
参照 
「 1000000007 で 割っ た あまり 」 の 求め 方 を 総 特集 ！ 〜 逆 元 から 離散 対数 まで 〜 
フェルマー の 小 定理 の 証明 と 使い方 
