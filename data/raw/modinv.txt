拡張Euclidの互除法による逆元計算
atcoderでmod計算に困ったので，次から困らないようにマクロを書いてやろうと思い調査した．今回の問題は，modを使ったもので，組み合わせの計算をする時に，factorialのモジュラ逆元を計算しなければいけなくて困った．
問題
を計算するとはすなわち，
を満たすを求めたいということになる．
Euclidの互除法を適用すると，
となり，これを元の式に代入すると，
になる．これによって，に関する問題が，それより数値の小さなに関する問題に帰着できた．
これを再帰的に解くのが拡張Euclidの互除法．具体的には，に関する小問題を解いて，
と解が再帰的に得られたとすると，
となり，元の問題の解を構成できる．
実装
終了条件に注意して実装．
非再帰で書いたものをアンローリング展開しているもの（コードは理解できない）は以下．
参照
「1000000007 で割ったあまり」の求め方を総特集！ 〜 逆元から離散対数まで 〜
フェルマーの小定理の証明と使い方
See Also
